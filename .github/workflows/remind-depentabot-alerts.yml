name: Remind Dependabot alerts
on:
  schedule:
    # 好きな間隔で設定
    - cron: '0 1/6/9 * * *'
  # 手動
  workflow_dispatch:

jobs:
  dependabot-notifier:
    runs-on: ubuntu-latest
    steps:
      - name: GitHub CLI
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        # jqの整形は各自適当にやってください
        run: |
          gh api '/repos/<your_org>/<your_repository>/dependabot/alerts?state=open' \
             --jq \
             'map({
                c: .created_at,
                e: .dependency.package.ecosystem,
                n: .dependency.package.name,
                s: .security_vulnerability.severity
              })
              | unique_by(.s, .e, .n)
              | sort_by(.c)
              | reverse[]
              | "\(.s) on (\(.c)):  \(.e) の \(.n)"
             ' > vuls.txt || true

      - name: cat result
        run: cat vuls.txt
